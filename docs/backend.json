{
  "entities": {
    "ContactInformation": {
      "title": "Contact Information",
      "type": "object",
      "description": "Stores the primary contact details for the business.",
      "properties": {
        "email": {
          "type": "string",
          "format": "email",
          "description": "Primary contact email address."
        },
        "phone": {
          "type": "string",
          "description": "Primary contact phone number."
        },
        "address": {
          "type": "string",
          "description": "Physical address of the business."
        }
      },
      "required": [
        "email",
        "phone",
        "address"
      ]
    },
    "SubscriptionPlan": {
      "title": "Subscription Plan",
      "type": "object",
      "description": "Represents a subscription plan for patients.",
      "properties": {
        "name": {
          "type": "string",
          "description": "Name of the subscription plan."
        },
        "description": {
          "type": "string",
          "description": "A short description of the plan."
        },
        "price": {
          "type": "number",
          "description": "Monthly price of the plan."
        },
        "features": {
          "type": "array",
          "description": "List of features included in the plan.",
          "items": {
            "type": "string"
          }
        },
        "isFeatured": {
          "type": "boolean",
          "description": "Whether this plan should be highlighted."
        },
        "durationInDays": {
          "type": "number",
          "description": "Duration of the plan in days."
        },
        "imageUrl": {
          "type": "string",
          "description": "URL for a representative image for the plan."
        },
        "videoUrl": {
          "type": "string",
          "description": "URL for a promotional video for the plan."
        },
        "content": {
          "type": "string",
          "description": "Detailed content or description for the plan, can include markdown."
        }
      },
      "required": [
        "name",
        "description",
        "price",
        "features",
        "durationInDays"
      ]
    },
    "Therapist": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Therapist",
      "type": "object",
      "description": "Represents a physiotherapy therapist.",
      "properties": {
        "name": {
          "type": "string",
          "description": "Therapist's full name."
        },
        "title": {
          "type": "string",
          "description": "Therapist's professional title."
        },
        "bio": {
          "type": "string",
          "description": "Biography of the therapist, including qualifications and specializations."
        },
        "imageUrl": {
          "type": "string",
          "description": "URL for the therapist's profile picture. Can be a public URL or a data URI.",
          "format": "uri"
        },
        "specializations": {
          "type": "array",
          "description": "List of specializations for the therapist.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "name",
        "title",
        "bio",
        "imageUrl",
        "specializations"
      ]
    },
    "Product": {
      "title": "Product",
      "type": "object",
      "description": "Represents a product sold in the e-commerce store.",
      "properties": {
        "name": {
          "type": "string",
          "description": "Name of the product."
        },
        "description": {
          "type": "string",
          "description": "Description of the product."
        },
        "price": {
          "type": "number",
          "description": "Price of the product."
        },
        "imageUrl": {
          "type": "string",
          "description": "URL for the product's image. Can be a public URL or a data URI.",
          "format": "uri"
        }
      },
      "required": [
        "name",
        "description",
        "price",
        "imageUrl"
      ]
    },
    "Condition": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Condition",
      "type": "object",
      "description": "Represents a medical condition that physiotherapy can treat.",
      "properties": {
        "name": {
          "type": "string",
          "description": "Name of the condition."
        },
        "slug": {
          "type": "string",
          "description": "URL-friendly slug for the condition."
        },
        "description": {
          "type": "string",
          "description": "Detailed description of the condition, including symptoms and causes."
        },
        "treatmentOptions": {
          "type": "string",
          "description": "Summary of available physiotherapy treatment options."
        },
        "relatedGuideSlugs": {
          "type": "array",
          "description": "A list of slugs for related treatment guides.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "name",
        "slug",
        "description",
        "treatmentOptions"
      ]
    },
    "TreatmentGuide": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Treatment Guide",
      "type": "object",
      "description": "Represents an expert-guided exercise guide for patient recovery.",
      "properties": {
        "title": {
          "type": "string",
          "description": "The title of the treatment guide."
        },
        "slug": {
          "type": "string",
          "description": "URL-friendly slug for the guide."
        },
        "description": {
          "type": "string",
          "description": "A brief description of what the guide is for."
        },
        "imageUrl": {
          "type": "string",
          "description": "URL for the guide's representative image. Can be a public URL or a data URI.",
          "format": "uri"
        },
        "videoUrl": {
          "type": "string",
          "description": "URL for an instructional video, e.g., from YouTube.",
          "format": "uri"
        },
        "steps": {
          "type": "array",
          "description": "An array of steps for the guide.",
          "items": {
            "type": "object",
            "properties": {
              "title": {
                "type": "string",
                "description": "The title of the step."
              },
              "instructions": {
                "type": "string",
                "description": "The detailed instructions for the step."
              }
            },
            "required": [
              "title",
              "instructions"
            ]
          }
        }
      },
      "required": [
        "title",
        "slug",
        "description",
        "imageUrl",
        "steps"
      ]
    },
    "Appointment": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Appointment",
      "type": "object",
      "description": "Represents a booked physiotherapy appointment.",
      "properties": {
        "patientName": {
          "type": "string",
          "description": "Name of the patient."
        },
        "email": {
          "type": "string",
          "description": "Email address of the patient.",
          "format": "email"
        },
        "phoneNumber": {
          "type": "string",
          "description": "Phone number of the patient."
        },
        "appointmentDateTime": {
          "type": "string",
          "description": "Date and time of the appointment in ISO format.",
          "format": "date-time"
        },
        "therapistId": {
          "type": "string",
          "description": "ID of the therapist for this appointment."
        },
        "status": {
          "type": "string",
          "description": "Status of the appointment.",
          "enum": [
            "pending",
            "confirmed",
            "cancelled"
          ]
        }
      },
      "required": [
        "patientName",
        "email",
        "phoneNumber",
        "appointmentDateTime",
        "therapistId",
        "status"
      ]
    },
    "ContactFormSubmission": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ContactFormSubmission",
      "type": "object",
      "description": "Represents a submission from the contact form.",
      "properties": {
        "name": {
          "type": "string",
          "description": "Name of the person submitting the form."
        },
        "email": {
          "type": "string",
          "description": "Email address of the person submitting the form.",
          "format": "email"
        },
        "subject": {
          "type": "string",
          "description": "The subject of the message."
        },
        "message": {
          "type": "string",
          "description": "The message submitted through the contact form."
        },
        "submittedAt": {
          "type": "string",
          "description": "Date and time of the form submission.",
          "format": "date-time"
        }
      },
      "required": [
        "name",
        "email",
        "subject",
        "message",
        "submittedAt"
      ]
    },
    "TherapistAvailability": {
      "title": "Therapist Availability",
      "type": "object",
      "description": "Represents the available time slots for a therapist on a specific date.",
      "properties": {
        "timeSlots": {
          "type": "array",
          "description": "List of available time slots in HH:mm format.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "timeSlots"
      ]
    },
    "SocialLink": {
      "title": "Social Link",
      "type": "object",
      "description": "Represents a social media link for the website.",
      "properties": {
        "platform": {
          "type": "string",
          "description": "Name of the social media platform (e.g., 'twitter', 'facebook', 'instagram')."
        },
        "url": {
          "type": "string",
          "description": "The full URL of the social media profile.",
          "format": "uri"
        }
      },
      "required": [
        "platform",
        "url"
      ]
    },
    "UserSubscription": {
      "title": "User Subscription",
      "type": "object",
      "description": "Represents a user's subscription to a plan.",
      "properties": {
        "userId": {
          "type": "string"
        },
        "userEmail": {
          "type": "string"
        },
        "planId": {
          "type": "string"
        },
        "planName": {
          "type": "string"
        },
        "status": {
          "type": "string",
          "enum": [
            "active",
            "cancelled"
          ]
        },
        "startDate": {
          "type": "string",
          "format": "date-time",
          "description": "The date the subscription starts."
        },
        "endDate": {
          "type": "string",
          "format": "date-time",
          "description": "The date the subscription automatically expires."
        },
        "price": {
          "type": "number"
        }
      },
      "required": [
        "userId",
        "userEmail",
        "planId",
        "planName",
        "status",
        "startDate",
        "price",
        "endDate"
      ]
    },
    "Feedback": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Feedback",
      "type": "object",
      "description": "Represents feedback submitted by a customer.",
      "properties": {
        "rating": {
          "type": "number",
          "description": "The star rating given by the customer (1-5)."
        },
        "experience": {
          "type": "string",
          "description": "The detailed feedback or experience description."
        },
        "userId": {
          "type": "string",
          "description": "The ID of the user who submitted the feedback (if logged in)."
        },
        "userDisplayName": {
          "type": "string",
          "description": "The display name of the user (if logged in)."
        },
        "submittedAt": {
          "type": "string",
          "description": "Date and time of the feedback submission.",
          "format": "date-time"
        }
      },
      "required": [
        "rating",
        "experience",
        "submittedAt"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "google.com",
      "phone"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/contactInformation/{docId}",
        "definition": {
          "entityName": "ContactInformation",
          "schema": {
            "$ref": "#/backend/entities/ContactInformation"
          },
          "description": "Stores the business's main contact details. Expects a single document with a known ID like 'main'.",
          "params": [
            {
              "name": "docId",
              "description": "The unique identifier for the contact information document (e.g., 'main')."
            }
          ]
        }
      },
      {
        "path": "/socialLinks/{linkId}",
        "definition": {
          "entityName": "SocialLink",
          "schema": {
            "$ref": "#/backend/entities/SocialLink"
          },
          "description": "Stores social media links for the website footer.",
          "params": [
            {
              "name": "linkId",
              "description": "Unique identifier for the social link."
            }
          ]
        }
      },
      {
        "path": "/subscriptionPlans/{planId}",
        "definition": {
          "entityName": "SubscriptionPlan",
          "schema": {
            "$ref": "#/backend/entities/SubscriptionPlan"
          },
          "description": "Stores details for patient subscription plans.",
          "params": [
            {
              "name": "planId",
              "description": "Unique identifier for the plan."
            }
          ]
        }
      },
      {
        "path": "/therapists/{therapistId}",
        "definition": {
          "entityName": "Therapist",
          "schema": {
            "$ref": "#/backend/entities/Therapist"
          },
          "description": "Stores therapist profiles.",
          "params": [
            {
              "name": "therapistId",
              "description": "Unique identifier for the therapist."
            }
          ]
        }
      },
      {
        "path": "/products/{productId}",
        "definition": {
          "entityName": "Product",
          "schema": {
            "$ref": "#/backend/entities/Product"
          },
          "description": "Stores product information for the e-commerce store.",
          "params": [
            {
              "name": "productId",
              "description": "Unique identifier for the product."
            }
          ]
        }
      },
      {
        "path": "/conditions/{conditionId}",
        "definition": {
          "entityName": "Condition",
          "schema": {
            "$ref": "#/backend/entities/Condition"
          },
          "description": "Stores information about medical conditions.",
          "params": [
            {
              "name": "conditionId",
              "description": "Unique identifier for the condition, typically a slug."
            }
          ]
        }
      },
      {
        "path": "/treatmentGuides/{guideId}",
        "definition": {
          "entityName": "TreatmentGuide",
          "schema": {
            "$ref": "#/backend/entities/TreatmentGuide"
          },
          "description": "Stores treatment guides with steps.",
          "params": [
            {
              "name": "guideId",
              "description": "Unique identifier for the treatment guide."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/subscriptions/{subscriptionId}",
        "definition": {
          "entityName": "UserSubscription",
          "schema": {
            "$ref": "#/backend/entities/UserSubscription"
          },
          "description": "Stores a user's active and past subscriptions.",
          "params": [
            {
              "name": "userId",
              "description": "The user's unique ID."
            },
            {
              "name": "subscriptionId",
              "description": "The unique ID for the subscription record."
            }
          ]
        }
      },
      {
        "path": "/therapists/{therapistId}/appointments/{appointmentId}",
        "definition": {
          "entityName": "Appointment",
          "schema": {
            "$ref": "#/backend/entities/Appointment"
          },
          "description": "Stores appointment bookings, nested under the respective therapist.",
          "params": [
            {
              "name": "therapistId",
              "description": "Unique identifier for the therapist."
            },
            {
              "name": "appointmentId",
              "description": "Unique identifier for the appointment."
            }
          ]
        }
      },
      {
        "path": "/therapists/{therapistId}/availability/{date}",
        "definition": {
          "entityName": "TherapistAvailability",
          "schema": {
            "$ref": "#/backend/entities/TherapistAvailability"
          },
          "description": "Stores available time slots for a therapist for a specific day. The document ID is the date in YYYY-MM-DD format.",
          "params": [
            {
              "name": "therapistId",
              "description": "Unique identifier for the therapist."
            },
            {
              "name": "date",
              "description": "The date in YYYY-MM-DD format."
            }
          ]
        }
      },
      {
        "path": "/contactFormSubmissions/{contactFormSubmissionId}",
        "definition": {
          "entityName": "ContactFormSubmission",
          "schema": {
            "$ref": "#/backend/entities/ContactFormSubmission"
          },
          "description": "Stores contact form submissions for review.",
          "params": [
            {
              "name": "contactFormSubmissionId",
              "description": "Unique identifier for the contact form submission."
            }
          ]
        }
      },
      {
        "path": "/feedback/{feedbackId}",
        "definition": {
          "entityName": "Feedback",
          "schema": {
            "$ref": "#/backend/entities/Feedback"
          },
          "description": "Stores customer feedback and ratings.",
          "params": [
            {
              "name": "feedbackId",
              "description": "Unique identifier for the feedback submission."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to efficiently manage physiotherapy-related data while prioritizing security and scalability. It leverages path-based ownership and structural segregation to simplify security rules and ensure data integrity.  Therapist, Condition, and TreatmentGuide data are stored in root-level collections, intended to be globally available. Appointments are stored within a therapist's document for easy retrieval. ContactFormSubmissions are stored in a dedicated collection for review. A dedicated `admins` collection is used to manage user privileges for administrative tasks. \n\nAuthorization Independence is achieved by not relying on `get()` calls in security rules, except for checking admin status. Data requiring specific access controls (e.g., user-specific data, collaborative content) would need to denormalize authorization-related data into the documents themselves.\n\nThis structure supports QAPs by:\n\n*   Segregating data based on access requirements. Public data (Therapists, Conditions, TreatmentGuides) are stored separately from potentially private data (Appointments, ContactFormSubmissions).\n*   Leveraging path-based ownership for user-specific data, enabling secure list operations based on user ID.\n*   Providing a clear and secure mechanism for admin-level access control."
  }
}

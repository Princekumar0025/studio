{
  "entities": {
    "Therapist": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Therapist",
      "type": "object",
      "description": "Represents a physiotherapy therapist.",
      "properties": {
        "name": {
          "type": "string",
          "description": "Therapist's full name."
        },
        "title": {
          "type": "string",
          "description": "Therapist's professional title."
        },
        "bio": {
          "type": "string",
          "description": "Biography of the therapist, including qualifications and specializations."
        },
        "imageId": {
          "type": "string",
          "description": "ID for the placeholder image."
        },
        "specializations": {
          "type": "array",
          "description": "List of specializations for the therapist.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "name",
        "title",
        "bio",
        "imageId",
        "specializations"
      ]
    },
    "Product": {
      "title": "Product",
      "type": "object",
      "description": "Represents a product sold in the e-commerce store.",
      "properties": {
        "name": {
          "type": "string",
          "description": "Name of the product."
        },
        "description": {
          "type": "string",
          "description": "Description of the product."
        },
        "price": {
          "type": "number",
          "description": "Price of the product."
        },
        "imageId": {
          "type": "string",
          "description": "ID for the placeholder image."
        }
      },
      "required": [
        "name",
        "description",
        "price",
        "imageId"
      ]
    },
    "Condition": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Condition",
      "type": "object",
      "description": "Represents a medical condition that physiotherapy can treat.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the condition."
        },
        "name": {
          "type": "string",
          "description": "Name of the condition."
        },
        "slug": {
          "type": "string",
          "description": "URL-friendly slug for the condition."
        },
        "description": {
          "type": "string",
          "description": "Detailed description of the condition, including symptoms and causes."
        },
        "treatmentOptions": {
          "type": "string",
          "description": "Summary of available physiotherapy treatment options."
        }
      },
      "required": [
        "id",
        "name",
        "slug",
        "description",
        "treatmentOptions"
      ]
    },
    "TreatmentGuide": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "TreatmentGuide",
      "type": "object",
      "description": "Represents a guide for a specific physiotherapy treatment or exercise.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the treatment guide."
        },
        "title": {
          "type": "string",
          "description": "Title of the treatment guide."
        },
        "description": {
          "type": "string",
          "description": "Detailed description of the treatment or exercise."
        },
        "steps": {
          "type": "array",
          "description": "Array of steps for the treatment guide.",
          "items": {
            "type": "object",
            "properties": {
              "title": {
                "type": "string"
              },
              "instructions": {
                "type": "string"
              }
            },
            "required": ["title", "instructions"]
          }
        },
        "imageId": {
          "type": "string",
          "description": "ID for the placeholder image."
        },
        "conditionId": {
          "type": "string",
          "description": "Reference to Condition. (Relationship: Condition 1:N TreatmentGuide)"
        }
      },
      "required": [
        "id",
        "title",
        "description",
        "steps",
        "imageId"
      ]
    },
    "Appointment": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Appointment",
      "type": "object",
      "description": "Represents a booked physiotherapy appointment.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the appointment."
        },
        "patientName": {
          "type": "string",
          "description": "Name of the patient."
        },
        "email": {
          "type": "string",
          "description": "Email address of the patient.",
          "format": "email"
        },
        "phoneNumber": {
          "type": "string",
          "description": "Phone number of the patient."
        },
        "appointmentDateTime": {
          "type": "string",
          "description": "Date and time of the appointment.",
          "format": "date-time"
        },
        "therapistId": {
          "type": "string",
          "description": "Reference to Therapist. (Relationship: Therapist 1:N Appointment)"
        }
      },
      "required": [
        "id",
        "patientName",
        "email",
        "phoneNumber",
        "appointmentDateTime",
        "therapistId"
      ]
    },
    "ContactFormSubmission": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ContactFormSubmission",
      "type": "object",
      "description": "Represents a submission from the contact form.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the contact form submission."
        },
        "name": {
          "type": "string",
          "description": "Name of the person submitting the form."
        },
        "email": {
          "type": "string",
          "description": "Email address of the person submitting the form.",
          "format": "email"
        },
        "message": {
          "type": "string",
          "description": "The message submitted through the contact form."
        },
        "submissionDateTime": {
          "type": "string",
          "description": "Date and time of the form submission.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "name",
        "email",
        "message",
        "submissionDateTime"
      ]
    },
    "Admin": {
      "title": "Admin",
      "type": "object",
      "description": "Represents an administrator user. The existence of a document in the /admins collection with a user's UID as the document ID confers admin privileges.",
      "properties": {
        "addedOn": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp when the user was made an admin."
        }
      },
      "required": ["addedOn"]
    }
  },
  "auth": {
    "providers": [
      "google.com",
      "phone"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/therapists/{therapistId}",
        "definition": {
          "entityName": "Therapist",
          "schema": {
            "$ref": "#/backend/entities/Therapist"
          },
          "description": "Stores therapist profiles. Includes denormalized 'id' for easier querying and potential future authorization needs.",
          "params": [
            {
              "name": "therapistId",
              "description": "Unique identifier for the therapist."
            }
          ]
        }
      },
      {
        "path": "/products/{productId}",
        "definition": {
          "entityName": "Product",
          "schema": {
            "$ref": "#/backend/entities/Product"
          },
          "description": "Stores product information for the e-commerce store.",
          "params": [
            {
              "name": "productId",
              "description": "Unique identifier for the product."
            }
          ]
        }
      },
      {
        "path": "/conditions/{conditionId}",
        "definition": {
          "entityName": "Condition",
          "schema": {
            "$ref": "#/backend/entities/Condition"
          },
          "description": "Stores information about medical conditions. Includes denormalized 'id' for simpler lookups.",
          "params": [
            {
              "name": "conditionId",
              "description": "Unique identifier for the condition."
            }
          ]
        }
      },
      {
        "path": "/conditions/{conditionId}/treatmentGuides/{treatmentGuideId}",
        "definition": {
          "entityName": "TreatmentGuide",
          "schema": {
            "$ref": "#/backend/entities/TreatmentGuide"
          },
          "description": "Stores treatment guides for specific conditions.  Related to condition via 'conditionId' field.",
          "params": [
            {
              "name": "conditionId",
              "description": "Unique identifier for the condition."
            },
            {
              "name": "treatmentGuideId",
              "description": "Unique identifier for the treatment guide."
            }
          ]
        }
      },
      {
        "path": "/therapists/{therapistId}/appointments/{appointmentId}",
        "definition": {
          "entityName": "Appointment",
          "schema": {
            "$ref": "#/backend/entities/Appointment"
          },
          "description": "Stores appointment bookings, nested under the respective therapist. Path based ownership by therapist.",
          "params": [
            {
              "name": "therapistId",
              "description": "Unique identifier for the therapist."
            },
            {
              "name": "appointmentId",
              "description": "Unique identifier for the appointment."
            }
          ]
        }
      },
      {
        "path": "/contactFormSubmissions/{contactFormSubmissionId}",
        "definition": {
          "entityName": "ContactFormSubmission",
          "schema": {
            "$ref": "#/backend/entities/ContactFormSubmission"
          },
          "description": "Stores contact form submissions for review.",
          "params": [
            {
              "name": "contactFormSubmissionId",
              "description": "Unique identifier for the contact form submission."
            }
          ]
        }
      },
      {
        "path": "/admins/{userId}",
        "definition": {
          "entityName": "Admin",
          "schema": {
            "$ref": "#/backend/entities/Admin"
          },
          "description": "Stores a list of user UIDs that have admin privileges. The existence of a document grants admin rights.",
          "params": [
            {
              "name": "userId",
              "description": "The user's UID."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to efficiently manage physiotherapy-related data while prioritizing security and scalability. It leverages path-based ownership and structural segregation to simplify security rules and ensure data integrity.  Therapist, Condition, and TreatmentGuide data are stored in root-level collections, intended to be globally available. Appointments are stored within a therapist's document for easy retrieval. ContactFormSubmissions are stored in a dedicated collection for review. A dedicated `admins` collection is used to manage user privileges for administrative tasks. \n\nAuthorization Independence is achieved by not relying on `get()` calls in security rules, except for checking admin status. Data requiring specific access controls (e.g., user-specific data, collaborative content) would need to denormalize authorization-related data into the documents themselves.\n\nThis structure supports QAPs by:\n\n*   Segregating data based on access requirements. Public data (Therapists, Conditions, TreatmentGuides) are stored separately from potentially private data (Appointments, ContactFormSubmissions).\n*   Leveraging path-based ownership for user-specific data, enabling secure list operations based on user ID.\n*   Providing a clear and secure mechanism for admin-level access control."
  }
}
